<div class="row">
  <div class="col-sm-5">
    <div class="card">
      <div class="card-body text-center">
        <span class="titulo">M√©todo de Simpson</span>
        <p class="mt-3">
          El m√©todo de Simpson es una t√©cnica de integraci√≥n num√©rica que mejora la precisi√≥n al aproximar el √°rea bajo una curva. 
          Se basa en aproximar la funci√≥n por un polinomio de segundo grado en cada subintervalo, utilizando los puntos extremos y los puntos intermedios.
        </p>
        <p>
          Para aplicar este m√©todo, se necesitan:
        </p>
        <ul class="text-start">
          <li>Una <strong>funci√≥n</strong> f(x) que se desea integrar.</li>
          <li>El <strong>l√≠mite inferior</strong> a del intervalo.</li>
          <li>El <strong>l√≠mite superior</strong> b del intervalo.</li>
          <li>El <strong>n√∫mero de subintervalos</strong> n, que debe ser par y mayor o igual a 2 para que el m√©todo sea aplicable.</li>
        </ul>
        <p>
          Nota: La integral aproximada se calcula usando la f√≥rmula:
        </p>
        <p>
          I ‚âà (h / 3) * [f(a) + 4 * Œ£ f(x<sub>2i-1</sub>) + 2 * Œ£ f(x<sub>2i</sub>) + f(b)],
        </p>
        <p>
          donde h = (b - a) / n  es el ancho de cada subintervalo, y los x_i  son los puntos intermedios del intervalo. La f√≥rmula utiliza los valores de la funci√≥n en los puntos extremos, los puntos impares multiplicados por 4, y los puntos pares multiplicados por 2.
        </p>
        <p>
          Es importante que n sea par, ya que el m√©todo requiere que el n√∫mero de subintervalos sea divisible por 2 para asegurar la precisi√≥n en la estimaci√≥n de la integral.
        </p>
      </div>
    </div>
  </div>  
  <div class="col-sm-5">
    <div class="card">
      <div class="card-body text-center">
        <span class="titulo">{{titulo}}</span>
        <form class="mt-3" [formGroup]="eventForm" (ngSubmit)="consulta()">
          <div class="mb-3">
            <label class="block mb-2 text-sm font-bold text-gray-700" for="description">
              Funci√≥n
            </label>
            <div class="input-group">
              <input type="text" formControlName="funcion" class="form-control form-control-lg" placeholder="Funci√≥n" readonly>
              <button type="button" class="btn btn-secondary" (click)="openCalculator('funcion')">üßÆ</button>
            </div>
            <div class="text-danger" *ngIf="eventForm.get('funcion')?.hasError('required') && eventForm.get('funcion')?.touched">
              <span>La funci√≥n <strong>es obligatoria</strong></span>
            </div>
          </div>
          <div class="mb-3">
            <label class="block mb-2 text-sm font-bold text-gray-700" for="description">
              L√≠mite a - L√≠mite inferior
            </label>
            <input type="number" formControlName="limitea" class="form-control form-control-lg" placeholder="L√≠mite a">
            <div class="text-danger" *ngIf="eventForm.get('limitea')?.hasError('required') && eventForm.get('limitea')?.touched">
              <span>El l√≠mite a de la funci√≥n <strong>es obligatorio</strong></span>
            </div>
          </div>
          <div class="mb-3">
            <label class="block mb-2 text-sm font-bold text-gray-700" for="description">
              L√≠mite b - L√≠mite superior
            </label>
            <input type="number" formControlName="limiteb" class="form-control form-control-lg" placeholder="Limite b">
            <div class="text-danger" *ngIf="eventForm.get('limiteb')?.hasError('required') && eventForm.get('limiteb')?.touched">
              <span>El l√≠mite b de la funci√≥n <strong>es obligatorio</strong></span>
            </div>
          </div>
          <div class="mb-3">
            <label class="block mb-2 text-sm font-bold text-gray-700" for="description">
              N√∫mero de im√°genes
            </label>
            <input 
              type="number" 
              formControlName="nimagenes" 
              class="form-control form-control-lg" 
              placeholder="N√∫mero de im√°genes"
              min="2"
              [ngClass]="{
                'is-invalid': eventForm.get('nimagenes')?.invalid && (eventForm.get('nimagenes')?.touched || eventForm.get('nimagenes')?.dirty),
                'is-valid': eventForm.get('nimagenes')?.valid
              }"
            >
            <div class="text-danger" *ngIf="eventForm.get('nimagenes')?.hasError('required') && eventForm.get('nimagenes')?.touched">
              <span>El n√∫mero de im√°genes es obligatorio</span>
            </div>
            <div class="text-danger" *ngIf="eventForm.get('nimagenes')?.value % 2 !== 0 && !eventForm.get('nimagenes')?.hasError('required') && eventForm.get('nimagenes')?.touched">
              <span>El n√∫mero de im√°genes debe ser par</span>
            </div>
          </div>
          <div class="mb-3">
            <button type="button" routerLink="/**" class="btn btn-secondary btn-lg float-start">VOLVER</button>
            <button type="submit" [disabled]="eventForm.invalid" class="btn btn-success btn-lg float-end">ACEPTAR</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-sm-7">
    <div class="card">
      <div class="card-body text-center">
        <span class="titulo">Resultados</span>
        <br>
        <span>√Årea Encontrada: {{raiz}}</span>
        <br>
        <span class="titulo">Gr√°fica</span>
        <br>
        <img *ngIf="imagen" [src]="imagen" alt="Gr√°fica">
        <table *ngIf="lista.length >= 0" class="table table-striped mt-3">
          <thead>
            <tr>
              <th scope="col">Punto evaluado</th>
              <th scope="col">Im√°gen</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let punto of lista">
              <td>{{ punto.x }}</td>
              <td>{{ punto.y }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<br>

<!-- Modal para la calculadora -->
<div class="modal" tabindex="-1" role="dialog" id="calculatorModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <app-calculator (close)="closeCalculator()" (save)="saveFunction($event)"></app-calculator>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeCalculator()">Cerrar</button>
      </div>
    </div>
  </div>
</div>
